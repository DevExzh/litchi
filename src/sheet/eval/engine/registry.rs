use crate::sheet::{CellValue, Result};
use phf::phf_map;

use super::super::parser::Expr;
use super::{EngineCtx, ReferenceResolver};

use std::future::Future;
use std::pin::Pin;

pub(crate) type BoxFuture<'a, T> = Pin<Box<dyn Future<Output = T> + Send + 'a>>;

pub(crate) trait DispatchCtx: EngineCtx + ReferenceResolver + Send + Sync {}

impl<T> DispatchCtx for T where T: EngineCtx + ReferenceResolver + Send + Sync + ?Sized {}

pub(crate) type DispatchFn =
    for<'a> fn(&'a dyn DispatchCtx, &'a str, &'a [Expr]) -> BoxFuture<'a, Result<CellValue>>;

fn eval_pi<'a>(
    _: &'a dyn DispatchCtx,
    _: &'a str,
    _: &'a [Expr],
) -> BoxFuture<'a, Result<CellValue>> {
    Box::pin(async move { Ok(CellValue::Float(std::f64::consts::PI)) })
}

macro_rules! register_functions {
    ($( $wrapper:ident => $path:path => [$($name:expr),+ $(,)?] ),+ $(,)? ) => {
        $(
            fn $wrapper<'a>(ctx: &'a dyn DispatchCtx, current_sheet: &'a str, args: &'a [Expr]) -> BoxFuture<'a, Result<CellValue>> {
                Box::pin($path(ctx, current_sheet, args))
            }
        )+

        pub(crate) static FUNCTION_MAP: phf::Map<&'static str, DispatchFn> = phf_map! {
            $(
                $( $name => $wrapper as DispatchFn, )+
            )+
        };
    };
}

register_functions!(
    // Aggregate
    wrap_sum => super::aggregate::eval_sum => ["SUM"],
    wrap_sumproduct => super::aggregate::eval_sumproduct => ["SUMPRODUCT"],
    wrap_product => super::aggregate::eval_product => ["PRODUCT"],
    wrap_min => super::aggregate::eval_min => ["MIN"],
    wrap_max => super::aggregate::eval_max => ["MAX"],
    wrap_average => super::aggregate::eval_average => ["AVERAGE"],
    wrap_averagea => super::aggregate::eval_averagea => ["AVERAGEA"],
    wrap_avedev => super::aggregate::eval_avedev => ["AVEDEV"],
    wrap_count => super::aggregate::eval_count => ["COUNT"],
    wrap_counta => super::aggregate::eval_counta => ["COUNTA"],
    wrap_countblank => super::aggregate::eval_countblank => ["COUNTBLANK"],
    wrap_mina => super::aggregate::eval_mina => ["MINA"],
    wrap_maxa => super::aggregate::eval_maxa => ["MAXA"],

    // Criteria Aggregates
    wrap_sumif => super::criteria_aggs::eval_sumif => ["SUMIF"],
    wrap_sumifs => super::criteria_aggs::eval_sumifs => ["SUMIFS"],
    wrap_countif => super::criteria_aggs::eval_countif => ["COUNTIF"],
    wrap_countifs => super::criteria_aggs::eval_countifs => ["COUNTIFS"],
    wrap_averageif => super::criteria_aggs::eval_averageif => ["AVERAGEIF"],
    wrap_averageifs => super::criteria_aggs::eval_averageifs => ["AVERAGEIFS"],
    wrap_minifs => super::criteria_aggs::eval_minifs => ["MINIFS"],
    wrap_maxifs => super::criteria_aggs::eval_maxifs => ["MAXIFS"],

    // Math - Arithmetic
    wrap_abs => super::math::eval_abs => ["ABS"],
    wrap_int => super::math::eval_int => ["INT"],
    wrap_round => super::math::eval_round => ["ROUND"],
    wrap_rounddown => super::math::eval_rounddown => ["ROUNDDOWN"],
    wrap_roundup => super::math::eval_roundup => ["ROUNDUP"],
    wrap_floor => super::math::eval_floor => ["FLOOR"],
    wrap_floor_math => super::math::eval_floor_math => ["FLOOR.MATH"],
    wrap_floor_precise => super::math::eval_floor_precise => ["FLOOR.PRECISE"],
    wrap_ceiling => super::math::eval_ceiling => ["CEILING"],
    wrap_ceiling_math => super::math::eval_ceiling_math => ["CEILING.MATH"],
    wrap_ceiling_precise => super::math::eval_ceiling_precise => ["CEILING.PRECISE"],
    wrap_iso_ceiling => super::math::eval_iso_ceiling => ["ISO.CEILING"],
    wrap_mod => super::math::eval_mod => ["MOD"],
    wrap_mround => super::math::eval_mround => ["MROUND"],
    wrap_quotient => super::math::eval_quotient => ["QUOTIENT"],
    wrap_gcd => super::math::eval_gcd => ["GCD"],
    wrap_lcm => super::math::eval_lcm => ["LCM"],
    wrap_trunc => super::math::eval_trunc => ["TRUNC"],
    wrap_even => super::math::eval_even => ["EVEN"],
    wrap_odd => super::math::eval_odd => ["ODD"],
    wrap_sign => super::math::eval_sign => ["SIGN"],
    wrap_power => super::math::eval_power => ["POWER"],
    wrap_sqrt => super::math::eval_sqrt => ["SQRT"],
    wrap_sqrtpi => super::math::eval_sqrtpi => ["SQRTPI"],
    wrap_exp => super::math::eval_exp => ["EXP"],
    wrap_ln => super::math::eval_ln => ["LN"],
    wrap_log10 => super::math::eval_log10 => ["LOG10"],
    wrap_log => super::math::eval_log => ["LOG"],
    wrap_pi => eval_pi => ["PI"],
    wrap_rand => super::math::eval_rand => ["RAND"],
    wrap_randbetween => super::math::eval_randbetween => ["RANDBETWEEN"],
    wrap_decimal => super::math::eval_decimal => ["DECIMAL"],
    wrap_delta => super::math::eval_delta => ["DELTA"],
    wrap_gestep => super::math::eval_gestep => ["GESTEP"],
    wrap_sumsq => super::math::eval_sumsq => ["SUMSQ"],
    wrap_sumx2my2 => super::math::eval_sumx2my2 => ["SUMX2MY2"],
    wrap_sumx2py2 => super::math::eval_sumx2py2 => ["SUMX2PY2"],
    wrap_sumxmy2 => super::math::eval_sumxmy2 => ["SUMXMY2"],
    wrap_seriessum => super::math::eval_seriessum => ["SERIESSUM"],
    wrap_vstack => super::math::eval_vstack => ["VSTACK"],
    wrap_hstack => super::math::eval_hstack => ["HSTACK"],
    wrap_wrapcols => super::math::eval_wrapcols => ["WRAPCOLS"],
    wrap_wraprows => super::math::eval_wraprows => ["WRAPROWS"],
    wrap_sequence => super::math::eval_sequence => ["SEQUENCE"],
    wrap_randarray => super::math::eval_randarray => ["RANDARRAY"],
    wrap_bitand => super::math::eval_bitand => ["BITAND"],
    wrap_bitor => super::math::eval_bitor => ["BITOR"],
    wrap_bitxor => super::math::eval_bitxor => ["BITXOR"],
    wrap_bitlshift => super::math::eval_bitlshift => ["BITLSHIFT"],
    wrap_bitrshift => super::math::eval_bitrshift => ["BITRSHIFT"],

    // Math - Trig
    wrap_sin => super::math::eval_sin => ["SIN"],
    wrap_cos => super::math::eval_cos => ["COS"],
    wrap_tan => super::math::eval_tan => ["TAN"],
    wrap_cot => super::math::eval_cot => ["COT"],
    wrap_csc => super::math::eval_csc => ["CSC"],
    wrap_sec => super::math::eval_sec => ["SEC"],
    wrap_asin => super::math::eval_asin => ["ASIN"],
    wrap_acos => super::math::eval_acos => ["ACOS"],
    wrap_atan => super::math::eval_atan => ["ATAN"],
    wrap_atan2 => super::math::eval_atan2 => ["ATAN2"],
    wrap_acot => super::math::eval_acot => ["ACOT"],
    wrap_acoth => super::math::eval_acoth => ["ACOTH"],
    wrap_sinh => super::math::eval_sinh => ["SINH"],
    wrap_cosh => super::math::eval_cosh => ["COSH"],
    wrap_tanh => super::math::eval_tanh => ["TANH"],
    wrap_csch => super::math::eval_csch => ["CSCH"],
    wrap_sech => super::math::eval_sech => ["SECH"],
    wrap_coth => super::math::eval_coth => ["COTH"],
    wrap_asinh => super::math::eval_asinh => ["ASINH"],
    wrap_acosh => super::math::eval_acosh => ["ACOSH"],
    wrap_atanh => super::math::eval_atanh => ["ATANH"],
    wrap_radians => super::math::eval_radians => ["RADIANS"],
    wrap_degrees => super::math::eval_degrees => ["DEGREES"],

    // Math - Combinatorics
    wrap_fact => super::math::eval_fact => ["FACT"],
    wrap_factdouble => super::math::eval_factdouble => ["FACTDOUBLE"],
    wrap_combin => super::math::eval_combin => ["COMBIN"],
    wrap_combina => super::math::eval_combina => ["COMBINA"],
    wrap_permut => super::math::eval_permut => ["PERMUT"],
    wrap_permutationa => super::math::eval_permutationa => ["PERMUTATIONA"],
    wrap_multinomial => super::math::eval_multinomial => ["MULTINOMIAL"],

    // Math - Conversions
    wrap_base => super::math::eval_base => ["BASE"],
    wrap_bin2dec => super::math::eval_bin2dec => ["BIN2DEC"],
    wrap_bin2hex => super::math::eval_bin2hex => ["BIN2HEX"],
    wrap_bin2oct => super::math::eval_bin2oct => ["BIN2OCT"],
    wrap_dec2bin => super::math::eval_dec2bin => ["DEC2BIN"],
    wrap_dec2hex => super::math::eval_dec2hex => ["DEC2HEX"],
    wrap_dec2oct => super::math::eval_dec2oct => ["DEC2OCT"],
    wrap_hex2bin => super::math::eval_hex2bin => ["HEX2BIN"],
    wrap_hex2dec => super::math::eval_hex2dec => ["HEX2DEC"],
    wrap_hex2oct => super::math::eval_hex2oct => ["HEX2OCT"],
    wrap_oct2bin => super::math::eval_oct2bin => ["OCT2BIN"],
    wrap_oct2dec => super::math::eval_oct2dec => ["OCT2DEC"],
    wrap_oct2hex => super::math::eval_oct2hex => ["OCT2HEX"],

    // Logical
    wrap_if => super::logical::eval_if => ["IF"],
    wrap_ifs => super::logical::eval_ifs => ["IFS"],
    wrap_and => super::logical::eval_and => ["AND"],
    wrap_or => super::logical::eval_or => ["OR"],
    wrap_xor => super::logical::eval_xor => ["XOR"],
    wrap_not => super::logical::eval_not => ["NOT"],
    wrap_switch => super::logical::eval_switch => ["SWITCH"],
    wrap_true => super::logical::eval_true => ["TRUE"],
    wrap_false => super::logical::eval_false => ["FALSE"],

    // Info
    wrap_isblank => super::info::eval_isblank => ["ISBLANK"],
    wrap_iserror => super::info::eval_iserror => ["ISERROR"],
    wrap_iserr => super::info::eval_iserr => ["ISERR"],
    wrap_isna => super::info::eval_isna => ["ISNA"],
    wrap_isnumber => super::info::eval_isnumber => ["ISNUMBER"],
    wrap_istext => super::info::eval_istext => ["ISTEXT"],
    wrap_islogical => super::info::eval_islogical => ["ISLOGICAL"],
    wrap_isnontext => super::info::eval_isnontext => ["ISNONTEXT"],
    wrap_iseven => super::info::eval_iseven => ["ISEVEN"],
    wrap_isodd => super::info::eval_isodd => ["ISODD"],
    wrap_isformula => super::info::eval_isformula => ["ISFORMULA"],
    wrap_isref => super::info::eval_isref => ["ISREF"],
    wrap_formulatext => super::info::eval_formulatext => ["FORMULATEXT"],
    wrap_info => super::info::eval_info => ["INFO"],
    wrap_na => super::info::eval_na => ["NA"],
    wrap_iferror => super::info::eval_iferror => ["IFERROR"],
    wrap_ifna => super::info::eval_ifna => ["IFNA"],
    wrap_n => super::info::eval_n => ["N"],
    wrap_t => super::info::eval_t => ["T"],
    wrap_type => super::info::eval_type => ["TYPE"],
    wrap_value => super::info::eval_value => ["VALUE"],
    wrap_sheet => super::info::eval_sheet => ["SHEET"],
    wrap_sheets => super::info::eval_sheets => ["SHEETS"],

    // Text
    wrap_len => super::text::eval_len => ["LEN"],
    wrap_lenb => super::text::eval_lenb => ["LENB"],
    wrap_lower => super::text::eval_lower => ["LOWER"],
    wrap_upper => super::text::eval_upper => ["UPPER"],
    wrap_asc => super::text::eval_asc => ["ASC"],
    wrap_jis => super::text::eval_jis => ["JIS", "DBCS"],
    wrap_proper => super::text::eval_proper => ["PROPER"],
    wrap_trim => super::text::eval_trim => ["TRIM"],
    wrap_concat => super::text::eval_concat => ["CONCAT", "CONCATENATE"],
    wrap_textjoin => super::text::eval_textjoin => ["TEXTJOIN"],
    wrap_char => super::text::eval_char => ["CHAR"],
    wrap_code => super::text::eval_code => ["CODE"],
    wrap_clean => super::text::eval_clean => ["CLEAN"],
    wrap_fixed => super::text::eval_fixed => ["FIXED"],
    wrap_dollar => super::text::eval_dollar => ["DOLLAR"],
    wrap_text => super::text::eval_text => ["TEXT"],
    wrap_left => super::text::eval_left => ["LEFT"],
    wrap_leftb => super::text::eval_leftb => ["LEFTB"],
    wrap_right => super::text::eval_right => ["RIGHT"],
    wrap_rightb => super::text::eval_rightb => ["RIGHTB"],
    wrap_mid => super::text::eval_mid => ["MID"],
    wrap_midb => super::text::eval_midb => ["MIDB"],
    wrap_replace => super::text::eval_replace => ["REPLACE"],
    wrap_replaceb => super::text::eval_replaceb => ["REPLACEB"],
    wrap_rept => super::text::eval_rept => ["REPT"],
    wrap_exact => super::text::eval_exact => ["EXACT"],
    wrap_find => super::text::eval_find => ["FIND"],
    wrap_findb => super::text::eval_findb => ["FINDB"],
    wrap_search => super::text::eval_search => ["SEARCH"],
    wrap_searchb => super::text::eval_searchb => ["SEARCHB"],
    wrap_phonetic => super::text::eval_phonetic => ["PHONETIC"],
    wrap_numbervalue => super::text::eval_numbervalue => ["NUMBERVALUE"],
    wrap_substitute => super::text::eval_substitute => ["SUBSTITUTE"],
    wrap_valuetotext => super::text::eval_valuetotext => ["VALUETOTEXT"],
    wrap_arraytotext => super::text::eval_arraytotext => ["ARRAYTOTEXT"],
    wrap_textbefore => super::text::eval_textbefore => ["TEXTBEFORE"],
    wrap_textafter => super::text::eval_textafter => ["TEXTAFTER"],
    wrap_textsplit => super::text::eval_textsplit => ["TEXTSPLIT"],
    wrap_unichar => super::text::eval_unichar => ["UNICHAR"],
    wrap_unicode => super::text::eval_unicode => ["UNICODE"],
    wrap_arabic => super::text::eval_arabic => ["ARABIC"],
    wrap_roman => super::text::eval_roman => ["ROMAN"],

    // Date & Time
    wrap_today => super::date_time::eval_today => ["TODAY"],
    wrap_now => super::date_time::eval_now => ["NOW"],
    wrap_date => super::date_time::eval_date => ["DATE"],
    wrap_time => super::date_time::eval_time => ["TIME"],
    wrap_datevalue => super::date_time::eval_datevalue => ["DATEVALUE"],
    wrap_timevalue => super::date_time::eval_timevalue => ["TIMEVALUE"],
    wrap_year => super::date_time::eval_year => ["YEAR"],
    wrap_month => super::date_time::eval_month => ["MONTH"],
    wrap_day => super::date_time::eval_day => ["DAY"],
    wrap_hour => super::date_time::eval_hour => ["HOUR"],
    wrap_minute => super::date_time::eval_minute => ["MINUTE"],
    wrap_second => super::date_time::eval_second => ["SECOND"],
    wrap_weekday => super::date_time::eval_weekday => ["WEEKDAY"],
    wrap_weeknum => super::date_time::eval_weeknum => ["WEEKNUM"],
    wrap_isoweeknum => super::date_time::eval_isoweeknum => ["ISOWEEKNUM"],
    wrap_datedif => super::date_time::eval_datedif => ["DATEDIF"],
    wrap_yearfrac => super::date_time::eval_yearfrac => ["YEARFRAC"],
    wrap_days => super::date_time::eval_days => ["DAYS"],
    wrap_days360 => super::date_time::eval_days360 => ["DAYS360"],
    wrap_edate => super::date_time::eval_edate => ["EDATE"],
    wrap_eomonth => super::date_time::eval_eomonth => ["EOMONTH"],
    wrap_workday => super::date_time::eval_workday => ["WORKDAY"],
    wrap_workday_intl => super::date_time::eval_workday_intl => ["WORKDAY.INTL"],
    wrap_networkdays => super::date_time::eval_networkdays => ["NETWORKDAYS"],
    wrap_networkdays_intl => super::date_time::eval_networkdays_intl => ["NETWORKDAYS.INTL"],

    // Lookup & Reference
    wrap_index => super::lookup::eval_index => ["INDEX"],
    wrap_match => super::lookup::eval_match => ["MATCH"],
    wrap_xmatch => super::lookup::eval_xmatch => ["XMATCH"],
    wrap_vlookup => super::lookup::eval_vlookup => ["VLOOKUP"],
    wrap_hlookup => super::lookup::eval_hlookup => ["HLOOKUP"],
    wrap_xlookup => super::lookup::eval_xlookup => ["XLOOKUP"],
    wrap_choose => super::lookup::eval_choose => ["CHOOSE"],
    wrap_column => super::lookup::eval_column => ["COLUMN"],
    wrap_row => super::lookup::eval_row => ["ROW"],
    wrap_rows => super::lookup::eval_rows => ["ROWS"],
    wrap_columns => super::lookup::eval_columns => ["COLUMNS"],

    // Statistical - Distributions
    wrap_norm_dist => super::statistical::eval_norm_dist => ["NORM.DIST", "NORMDIST"],
    wrap_norm_s_dist => super::statistical::eval_norm_s_dist => ["NORM.S.DIST", "NORMSDIST"],
    wrap_norm_s_inv => super::statistical::eval_norm_s_inv => ["NORM.S.INV", "NORMSINV"],
    wrap_norm_inv => super::statistical::eval_norm_inv => ["NORM.INV", "NORMINV"],
    wrap_binom_dist => super::statistical::eval_binom_dist => ["BINOM.DIST", "BINOMDIST"],
    wrap_binom_inv => super::statistical::eval_binom_inv => ["BINOM.INV", "CRITBINOM"],
    wrap_binom_dist_range => super::statistical::eval_binom_dist_range => ["BINOM.DIST.RANGE"],
    wrap_hypgeom_dist => super::statistical::eval_hypgeom_dist => ["HYPGEOM.DIST", "HYPGEOMDIST"],
    wrap_negbinom_dist => super::statistical::eval_negbinom_dist => ["NEGBINOM.DIST", "NEGBINOMDIST"],
    wrap_poisson_dist => super::statistical::eval_poisson_dist => ["POISSON.DIST", "POISSON"],
    wrap_expon_dist => super::statistical::eval_expon_dist => ["EXPON.DIST", "EXPONDIST"],
    wrap_gamma_dist => super::statistical::eval_gamma_dist => ["GAMMA.DIST", "GAMMADIST"],
    wrap_gammainv => super::statistical::eval_gammainv => ["GAMMAINV"],
    wrap_gammaln => super::statistical::eval_gammaln => ["GAMMALN", "GAMMALN.PRECISE"],
    wrap_lognorm_dist => super::statistical::eval_lognorm_dist => ["LOGNORM.DIST", "LOGNORMDIST"],
    wrap_lognorm_inv => super::statistical::eval_lognorm_inv => ["LOGNORM.INV", "LOGINV"],
    wrap_beta_dist => super::statistical::eval_beta_dist => ["BETA.DIST", "BETADIST"],
    wrap_beta_inv => super::statistical::eval_beta_inv => ["BETA.INV", "BETAINV"],
    wrap_weibull_dist => super::statistical::eval_weibull_dist => ["WEIBULL.DIST", "WEIBULL"],
    wrap_chisq_dist => super::statistical::eval_chisq_dist => ["CHISQ.DIST"],
    wrap_chisq_dist_rt => super::statistical::eval_chisq_dist_rt => ["CHISQ.DIST.RT", "CHIDIST"],
    wrap_chisq_inv => super::statistical::eval_chisq_inv => ["CHISQ.INV"],
    wrap_chisq_inv_rt => super::statistical::eval_chisq_inv_rt => ["CHISQ.INV.RT", "CHIINV"],
    wrap_t_dist => super::statistical::eval_t_dist => ["T.DIST"],
    wrap_t_dist_2t => super::statistical::eval_t_dist_2t => ["T.DIST.2T"],
    wrap_t_dist_rt => super::statistical::eval_t_dist_rt => ["T.DIST.RT", "TDIST"],
    wrap_t_inv => super::statistical::eval_t_inv => ["T.INV"],
    wrap_t_inv_2t => super::statistical::eval_t_inv_2t => ["T.INV.2T", "TINV"],
    wrap_f_dist => super::statistical::eval_f_dist => ["F.DIST"],
    wrap_f_dist_rt => super::statistical::eval_f_dist_rt => ["F.DIST.RT"],
    wrap_f_inv => super::statistical::eval_f_inv => ["F.INV"],
    wrap_f_inv_rt => super::statistical::eval_f_inv_rt => ["F.INV.RT"],

    // Statistical - Tests
    wrap_chisq_test => super::statistical::eval_chisq_test => ["CHISQ.TEST", "CHITEST"],
    wrap_t_test => super::statistical::eval_t_test => ["T.TEST", "TTEST"],
    wrap_f_test => super::statistical::eval_f_test => ["F.TEST", "FTEST"],
    wrap_z_test => super::statistical::eval_z_test => ["Z.TEST", "ZTEST"],

    // Statistical - Descriptive
    wrap_devsq => super::statistical::eval_devsq => ["DEVSQ"],
    wrap_fisher => super::statistical::eval_fisher => ["FISHER"],
    wrap_fisherinv => super::statistical::eval_fisherinv => ["FISHERINV"],
    wrap_standardize => super::statistical::eval_standardize => ["STANDARDIZE"],
    wrap_correl => super::statistical::eval_correl => ["CORREL"],
    wrap_covar_p => super::statistical::eval_covar_p => ["COVAR", "COVARIANCE.P"],
    wrap_covar_s => super::statistical::eval_covar_s => ["COVARIANCE.S"],
    wrap_prob => super::statistical::eval_prob => ["PROB"],
    wrap_percentile => super::statistical::eval_percentile => ["PERCENTILE"],
    wrap_percentile_inc => super::statistical::eval_percentile_inc => ["PERCENTILE.INC"],
    wrap_percentile_exc => super::statistical::eval_percentile_exc => ["PERCENTILE.EXC"],
    wrap_large => super::statistical::eval_large => ["LARGE"],
    wrap_small => super::statistical::eval_small => ["SMALL"],
    wrap_rank_eq => super::statistical::eval_rank_eq => ["RANK.EQ"],
    wrap_rank => super::statistical::eval_rank => ["RANK"],
    wrap_rank_avg => super::statistical::eval_rank_avg => ["RANK.AVG"],
    wrap_quartile => super::statistical::eval_quartile => ["QUARTILE"],
    wrap_quartile_inc => super::statistical::eval_quartile_inc => ["QUARTILE.INC"],
    wrap_quartile_exc => super::statistical::eval_quartile_exc => ["QUARTILE.EXC"],
    wrap_percentrank => super::statistical::eval_percentrank => ["PERCENTRANK"],
    wrap_percentrank_inc => super::statistical::eval_percentrank_inc => ["PERCENTRANK.INC"],
    wrap_percentrank_exc => super::statistical::eval_percentrank_exc => ["PERCENTRANK.EXC"],
    wrap_gauss => super::statistical::eval_gauss => ["GAUSS"],
    wrap_phi => super::statistical::eval_phi => ["PHI"],
    wrap_median => super::statistical::eval_median => ["MEDIAN"],
    wrap_mode_sngl => super::statistical::eval_mode_sngl => ["MODE.SNGL"],
    wrap_stdev_s => super::statistical::eval_stdev_s => ["STDEV", "STDEV.S"],
    wrap_stdev_p => super::statistical::eval_stdev_p => ["STDEVP", "STDEV.P"],
    wrap_var_s => super::statistical::eval_var_s => ["VAR", "VAR.S"],
    wrap_var_p => super::statistical::eval_var_p => ["VARP", "VAR.P"],
    wrap_stdev_a => super::statistical::eval_stdev_a => ["STDEVA"],
    wrap_stdev_pa => super::statistical::eval_stdev_pa => ["STDEVPA"],
    wrap_slope => super::statistical::eval_slope => ["SLOPE"],
    wrap_intercept => super::statistical::eval_intercept => ["INTERCEPT"],
    wrap_var_a => super::statistical::eval_var_a => ["VARA"],
    wrap_var_pa => super::statistical::eval_var_pa => ["VARPA"],
    wrap_steyx => super::statistical::eval_steyx => ["STEYX"],
    wrap_pearson => super::statistical::eval_pearson => ["PEARSON"],
    wrap_rsq => super::statistical::eval_rsq => ["RSQ"],
    wrap_geomean => super::statistical::eval_geomean => ["GEOMEAN"],
    wrap_harmean => super::statistical::eval_harmean => ["HARMEAN"],
    wrap_trimmean => super::statistical::eval_trimmean => ["TRIMMEAN"],
    wrap_skew => super::statistical::eval_skew => ["SKEW"],
    wrap_skew_p => super::statistical::eval_skew_p => ["SKEW.P"],
    wrap_kurt => super::statistical::eval_kurt => ["KURT"],
    wrap_confidence_norm => super::statistical::eval_confidence_norm => ["CONFIDENCE", "CONFIDENCE.NORM"],
    wrap_confidence_t => super::statistical::eval_confidence_t => ["CONFIDENCE.T"],

    // Financial
    wrap_pv => super::financial::eval_pv => ["PV"],
    wrap_fv => super::financial::eval_fv => ["FV"],
    wrap_fvschedule => super::financial::eval_fvschedule => ["FVSCHEDULE"],
    wrap_rate => super::financial::eval_rate => ["RATE"],
    wrap_npv => super::financial::eval_npv => ["NPV"],
    wrap_irr => super::financial::eval_irr => ["IRR"],
    wrap_xirr => super::financial::eval_xirr => ["XIRR"],
    wrap_xnpv => super::financial::eval_xnpv => ["XNPV"],
    wrap_pduration => super::financial::eval_pduration => ["PDURATION"],
    wrap_rri => super::financial::eval_rri => ["RRI"],
    wrap_pmt => super::financial::eval_pmt => ["PMT"],
    wrap_ppmt => super::financial::eval_ppmt => ["PPMT"],
    wrap_ipmt => super::financial::eval_ipmt => ["IPMT"],
    wrap_nominal => super::financial::eval_nominal => ["NOMINAL"],
    wrap_effect => super::financial::eval_effect => ["EFFECT"],
    wrap_mirr => super::financial::eval_mirr => ["MIRR"],
    wrap_ispmt => super::financial::eval_ispmt => ["ISPMT"],
    wrap_nper => super::financial::eval_nper => ["NPER"],
    wrap_yield => super::financial::eval_yield => ["YIELD"],
    wrap_yieldmat => super::financial::eval_yieldmat => ["YIELDMAT"],
    wrap_duration => super::financial::eval_duration => ["DURATION"],
    wrap_yielddisc => super::financial::eval_yielddisc => ["YIELDDISC"],
    wrap_vdb => super::financial::eval_vdb => ["VDB"],
    wrap_accrint => super::financial::eval_accrint => ["ACCRINT"],
    wrap_accrintm => super::financial::eval_accrintm => ["ACCRINTM"],
    wrap_amordegrc => super::financial::eval_amordegrc => ["AMORDEGRC"],
    wrap_amorlinc => super::financial::eval_amorlinc => ["AMORLINC"],
    wrap_coupdaybs => super::financial::eval_coupdaybs => ["COUPDAYBS"],
    wrap_coupdays => super::financial::eval_coupdays => ["COUPDAYS"],
    wrap_coupdaysnc => super::financial::eval_coupdaysnc => ["COUPDAYSNC"],
    wrap_coupncd => super::financial::eval_coupncd => ["COUPNCD"],
    wrap_coupnum => super::financial::eval_coupnum => ["COUPNUM"],
    wrap_couppcd => super::financial::eval_couppcd => ["COUPPCD"],
    wrap_disc => super::financial::eval_disc => ["DISC"],
    wrap_intrate => super::financial::eval_intrate => ["INTRATE"],
    wrap_pricedisc => super::financial::eval_pricedisc => ["PRICEDISC"],
    wrap_pricemat => super::financial::eval_pricemat => ["PRICEMAT"],
    wrap_received => super::financial::eval_received => ["RECEIVED"],
    wrap_sln => super::financial::eval_sln => ["SLN"],
    wrap_syd => super::financial::eval_syd => ["SYD"],
    wrap_db => super::financial::eval_db => ["DB"],
    wrap_ddb => super::financial::eval_ddb => ["DDB"],
    wrap_dollarde => super::financial::eval_dollarde => ["DOLLARDE"],
    wrap_dollarfr => super::financial::eval_dollarfr => ["DOLLARFR"],

    // Database
    wrap_daverage => super::database::eval_daverage => ["DAVERAGE"],
    wrap_dcount => super::database::eval_dcount => ["DCOUNT"],
    wrap_dcounta => super::database::eval_dcounta => ["DCOUNTA"],
    wrap_dget => super::database::eval_dget => ["DGET"],
    wrap_dmax => super::database::eval_dmax => ["DMAX"],
    wrap_dmin => super::database::eval_dmin => ["DMIN"],
    wrap_dproduct => super::database::eval_dproduct => ["DPRODUCT"],
    wrap_dstdev => super::database::eval_dstdev => ["DSTDEV"],
    wrap_dstdevp => super::database::eval_dstdevp => ["DSTDEVP"],
    wrap_dsum => super::database::eval_dsum => ["DSUM"],
    wrap_dvar => super::database::eval_dvar => ["DVAR"],
    wrap_dvarp => super::database::eval_dvarp => ["DVARP"],

    wrap_encodeurl => super::web::eval_encodeurl => ["ENCODEURL"],
    wrap_webservice => super::web::eval_webservice => ["WEBSERVICE"],
    wrap_filterxml => super::web::eval_filterxml => ["FILTERXML"],
    wrap_complex => super::engineering::eval_complex => ["COMPLEX"],
    wrap_convert => super::engineering::eval_convert => ["CONVERT"],
    wrap_imabs => super::engineering::eval_imabs => ["IMABS"],
    wrap_imaginary => super::engineering::eval_imaginary => ["IMAGINARY"],
    wrap_imreal => super::engineering::eval_imreal => ["IMREAL"],
    wrap_imargument => super::engineering::eval_imargument => ["IMARGUMENT"],
    wrap_imconjugate => super::engineering::eval_imconjugate => ["IMCONJUGATE"],
    wrap_imsum => super::engineering::eval_imsum => ["IMSUM"],
    wrap_imsub => super::engineering::eval_imsub => ["IMSUB"],
    wrap_improduct => super::engineering::eval_improduct => ["IMPRODUCT"],
    wrap_imdiv => super::engineering::eval_imdiv => ["IMDIV"],
    wrap_imsin => super::engineering::eval_imsin => ["IMSIN"],
    wrap_imcos => super::engineering::eval_imcos => ["IMCOS"],
    wrap_imtan => super::engineering::eval_imtan => ["IMTAN"],
    wrap_imsinh => super::engineering::eval_imsinh => ["IMSINH"],
    wrap_imcosh => super::engineering::eval_imcosh => ["IMCOSH"],
    wrap_imtanh => super::engineering::eval_imtanh => ["IMTANH"],
    wrap_imcsc => super::engineering::eval_imcsc => ["IMCSC"],
    wrap_imcsch => super::engineering::eval_imcsch => ["IMCSCH"],
    wrap_imsec => super::engineering::eval_imsec => ["IMSEC"],
    wrap_imsech => super::engineering::eval_imsech => ["IMSECH"],
    wrap_imcot => super::engineering::eval_imcot => ["IMCOT"],
    wrap_imsqrt => super::engineering::eval_imsqrt => ["IMSQRT"],
    wrap_imln => super::engineering::eval_imln => ["IMLN"],
    wrap_imlog10 => super::engineering::eval_imlog10 => ["IMLOG10"],
    wrap_imlog2 => super::engineering::eval_imlog2 => ["IMLOG2"],
    wrap_imexp => super::engineering::eval_imexp => ["IMEXP"],
    wrap_impower => super::engineering::eval_impower => ["IMPOWER"],
    wrap_erf => super::engineering::eval_erf => ["ERF"],
    wrap_erfc => super::engineering::eval_erfc => ["ERFC"],
    wrap_besseli => super::engineering::eval_besseli => ["BESSELI"],
    wrap_besselj => super::engineering::eval_besselj => ["BESSELJ"],
    wrap_besselk => super::engineering::eval_besselk => ["BESSELK"],
    wrap_bessely => super::engineering::eval_bessely => ["BESSELY"],
);
